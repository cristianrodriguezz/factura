<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
	<style>
	*{
		box-sizing: border-box;
		-webkit-user-select: none; /* Chrome, Opera, Safari */
		-moz-user-select: none; /* Firefox 2+ */
		-ms-user-select: none; /* IE 10+ */
		user-select: none; /* Standard syntax */
		margin: 0;
		padding: 0;
		
	}
.font{
	font-family: monospace;
  	font-size: 12px;
}


.bill-container{
	border-collapse: collapse;
	max-width: 8cm;
	min-width: 8cm;
	left:0;
	right: 0;
	border-collapse: collapse;
	font-family: monospace;
	font-size: 10.5px;
}
.title{
	font-family: monospace;
	font-size: 15px;
	text-align: center;
	letter-spacing: 4px;
	text-transform: uppercase;
	font-weight: 100;
}

.text-lg{
	font-size: 20px;
}

.text-center{
	text-align: center;
}

.title-second{
	font-family: monospace;
	font-size: 14px;
	text-align: center;
	letter-spacing: -0.2px;
	text-transform: uppercase;
	font-weight: 100;
	margin-top: 6px;
}


#qrcode {
	width: 75%
}

p {
	margin: 2px 0;
}

table table {
	width: 100%;
}
table{
	width: 100%;
}

table table tr td:last-child{
	text-align: right;
}

.border-top {
	border-top: 1px dashed;
}

.padding-b-3 {
	padding-bottom: 5px;
}

.padding-t-3 {
	padding-top: 5px;
}

form{
	display: flex;
	flex-direction: column;
}
.flex{
	display: flex;
} 
.justify-center{
	justify-content: space-between;
} 
.align-center{
	align-items: center;
}



	</style>
</head>
<body style="display: flex; gap: 50px; justify-content: center;">
	<div class="bill-container">
		<form id="formItem">
			<label for="cantidad">Cantidad</label>
			<input type="text" name="cantidad" id="cantidad" >
			<label for="precio">Precio</label>
			<input type="text" name="precio" id="precio" >
			<label for="id">Id del producto</label>
			<input type="text" placeholder="á181241-4" name="id" id="id" >
			<label for="nombre">Nombre de producto:</label>
			<input type="text" name="nombre" id="nombre" >
			<button>
				Agregar item 
			</button>
		</form>
		<form id="form">
			<label for="caja">Nro. Caja:</label>
			<input type="text" name="caja" id="caja" >
			<label for="cajero">Nro. Cajero</label>
			<input type="text" name="cajero" id="cajero" >
			<label for="numeroFactura">Nro. Factura</label>
			<input type="text" name="numeroFactura" id="numeroFactura" placeholder="Ej: 00008-00024095" >
			<label for="client">Nombre de cliente</label>
			<input type="text" name="client" id="client" >
			<label for="cuit">CUIT:</label>
			<input type="text" name="cuit" id="cuit" >
			<label for="calleYNumeracion">Calle y numeración:</label>
			<input type="text" placeholder="Ej: 1 DE MAYO 1086" name="calleYNumeracion" id="calleYNumeracion" >
			<label for="localidadCodigoPostalProvincia">Localidad, codigo postal y provincia:</label>
			<input type="text" name="localidadCodigoPostalProvincia" id="localidadCodigoPostalProvincia" placeholder="Ej: VILLA MERCEDES5730-SAN LUIS" >
			<label for="pesosEntregados">Entrega pesos:</label>
			<input type="text" name="pesosEntregados" id="pesosEntregados" >
			<label for="nombreCajero">Nombre cajero/a:</label>
			<input type="text" name="nombreCajero" id="nombreCajero" >
			<button>enter</button>
		</form>

	</div>
	<div>


	<div class="bill-container" id="ticket">
		<table >
			<tr>
				<td class="padding-b-3">
					<p>FALABELLA S A</p>
					<p >C.U.I.T. Nro.: 30655725829</p>
					<p>Ing. Brutos: 9019840917</p>
					<p>Suipacha 1111</p>
					<p>Piso 18</p>
					<p>CP. C1008AAW</p>
					<p>Cuidad e Buenos Aires</p>
					<p>Inicio de Actividades: 19/01/1992</p>
					<p>IVA RESPONSABLE INSCRIPTO</p>
					<p><span style="margin-right: 10px;">SODIMAC ARGENTINA  </span>CUIT : 30-65572582-9</p>
					<p>AV. SAN MARTIN 421 <span style="margin-left: 25px;"> SAN MARTIN</span></p>
					<p>Caja:<span id="caja" style="margin-right: 8px;">0013</span> Cajero: <span id="cajero">806</span> <span>CC:05012</span></p>
				</td>
			</tr>
			<tr>
				<td class="border-top padding-t-3 padding-b-3   ">
					<p style="min-width: 185px; text-align:center; letter-spacing: -0.2px"><strong>Cód. 081 - TIQUE FACTURA "A"</strong></p>
					<p style="text-align:end ;font-size: 11px;">N° <span id="numeroFactura">00008-00024095</span></p>

					<div style="display: flex; justify-content: space-between">
						<p>Fecha: <span class="fecha">22/04/24</span> </p>
						<p>Hora <span class="hora">13:31:21</span></p>
					</div>
				</td>
			</tr>
			<tr>
				<td class="border-top padding-t-3 padding-b-3">
					<div style="letter-spacing: 0px;">
						<p id="nombre">CASTRO HECTOR HUGO</p>
						<p id="nrocuit">CUIT Nro.: 23-31237586-9</p>
						<p >IVA RESPONSABLE INSCRIPTO</p>
						<p id="calleYNumeracion">1 DE MAYO 1086</p>
						<p id="localidadCodigoPostalProvincia ">VILLA MERCEDES5730-SAN LUIS</p>
						<br>
					</div>
				</td>
			<tr>
				<td class="border-top padding-t-3 padding-b-3">
					<div style="display: flex; font-weight: bold;">
						<p style="width: 65.5%">Cantidad/Precio Unit.</p>
						<p>Código</p>
					</div>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="min-width: 45%;">Descripción</p>
						<p style="min-width: 40px;">(%IVA)</p>
						<p>[%BI]</p>
						<p >Precio Neto</p>
					</div>
					<div id="items">

					</div>
					<div class="deduccion">
					</div>
				</td>
			</tr>
			</tr>
		</table>

		<button onclick="printDiv()" style="height: 30px; width: 100%; margin-top: 20px; ">imprimir</button>
	</div>
</body>
<script>
	let date = new Date()
	let day = date.getDate()
	let month = (date.getMonth() + 1).toString().padStart(2, '0')
	let year = date.getFullYear()
	
	let fecha = `${day}/${month}/${year}`

	let hours = date.getHours().toString().padStart(2, '0')
	let minutes = date.getMinutes().toString().padStart(2, '0')
	let seconds = date.getSeconds().toString().padStart(2, '0')
	
	const hora =  `${hours}:${minutes}:${seconds}`

	const $fecha = document.querySelector('.fecha')
	const $hora = document.querySelector('.hora')


	const $client = document.querySelector('.client')
	const $cuit = document.querySelector('.cuit')
	const $contribuyente = document.querySelector('.contribuyente')
	const $direccion = document.querySelector('.direccion')
	const $pago = document.querySelector('.pago')
	const $deduccion = document.querySelector('.deduccion')
	const $numeroFactura = document.querySelector('#numeroFactura')


	function createItemHTML(item) {
		const cantidad =  parseFloat(item.cantidad)
		const precioNeto = cantidad * parseFloat(item.precio)
		return `
		<div>
			<div style="display: flex;">
				<p style="min-width: 39.5%; margin-left: 15px">${cantidad.toFixed(2)}/ <span id="precioProducto">${item.precio}</span></p>
				<p>(21.00)</p>
			</div>
			<p>${item.id}</p>
			<div style="display: flex; justify-content: space-between">
				<p>${item.nombre}</p>
				<p>${precioNeto}</p>
			</div>
		</div>
		`
	}

	const $items = document.getElementById('items')

	const handleSubmitAddItem = (e) => {
		e.preventDefault()

		const formData = new FormData(e.target)


		const producto = {
			cantidad: formData.get('cantidad'),
			precio: formData.get('precio'),
			id: formData.get('id'),
			nombre: formData.get('nombre')
		} 


		$items.innerHTML += createItemHTML(producto)



	}
	


	const $formItem = document.getElementById('formItem')
	$formItem.addEventListener('submit', handleSubmitAddItem)
		

	const handleSubmitEdit = (e) => {
		e.preventDefault()

		const formData = new FormData(e.target)

	
		const data = {
			caja: formData.get('caja'),
			cajero: formData.get('cajero'),
			numeroFactura: formData.get('numeroFactura'),
			client: formData.get('client'),
			cuit: formData.get('cuit'),
			calleYNumeracion: formData.get('calleYNumeracion'),
			localidadCodigoPostalProvincia: formData.get('localidadCodigoPostalProvincia'),
		}


		$fecha.innerHTML = data.fecha
		$hora.innerHTML = data.hora
		$numeroFactura.innerText = data.factura

		let litros = data.total / data.precioXLitro

		let IVA = 21
		let tasa = 1.70
		let tasaXLitros = tasa * litros
		
		let ITC = data.itc * (data.total / data.precioXLitro)
		let subtotal = (data.total - (ITC * litros)) / 1.21
		let IVATotal = subtotal * 0.21
		let precioLitrosSinImpuesto = subtotal / litros
		let impuestoInterno = litros * ITC

		let itcXLitros = ITC * litros

		$deduccion.innerHTML = `	

					<p>${litros.toFixed(3)}/${precioLitrosSinImpuesto.toFixed(4)}</p>
					<p>ITC Unit.x Lt: ${ITC.toFixed(4)}</p>
					<p>(4)DIESEL 500</p>
					<div style="display: flex; justify-content: space-between">
						<p style="min-width: 45%;">${litros.toFixed(3)}-${data.precioXLitro}</p>
						<p>(21.00)</p>
						<p>[87.99]</p>
						<p style="min-width: 63.5px; text-align: end">${subtotal.toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="font-weight: bold">SUBTOTAL IMPORTE NETO NO GRAVADO</p>
						<p>0.00</p>
					</div>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="font-weight: bold">SUBTOTAL IMPORTE EXENTO</p>
						<p>0.00</p>
					</div>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="font-weight: bold">SUBTOTAL IMPORTE NETO GRAVADO</p>
						<p>${subtotal.toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex;font-weight: bold;">
						<p style="min-width: 61%; font-weight: bold">Concepto</p>
						<p>Base</p>
					</div>
					<div style="display: flex;">
						<p style="min-width: 61%">Alícuota: 21.00%</p>
						<p>${subtotal.toFixed(2)}</p>
						<div style="display:flex; justify-content: end;  width: 100%">
							<p>${IVATotal.toFixed(2)}</p>
						</div>
					</div>
					<div style="display: flex;justify-content: space-between;font-weight: bold;">
						<p >IMPORTE TOTAL IVA</p>
						<p>${IVATotal.toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex;">
						<p style="min-width: 61%">10 - IMPUESTOS INTERNOS ITEMS</p>
						<p>${subtotal.toFixed(2)}</p>
						<div style="display:flex; justify-content: end;  width: 100%">
							<p>${itcXLitros.toFixed(2)}</p>
						</div>
					</div>
					<div style="display: flex;">
						<p style="min-width: 61%">99 - Tasas</p>
						<p>${tasa.toFixed(2)}</p>
						<div style="display:flex; justify-content: end;  width: 100%">
							<p>${tasaXLitros.toFixed(2)}</p>
						</div>
					</div>
					<div style="display: flex;justify-content: space-between;font-weight: bold;">
						<p >IMPORTE TOTAL OTROS TRIBUTOS</p>
						<p>${(itcXLitros + tasaXLitros).toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex;justify-content: space-between;font-weight: bold; font-size: 18px">
						<p >TOTAL</p>
						<p>${data.total.toFixed(2)}</p>
					</div>
					<p >RECIBI(MOS)</p>
					<div style="display: flex;justify-content: space-between;">
						<p>Efectivo...</p>
						<p>${data.total.toFixed(2)}</p>
					</div>
					<div style="display: flex;justify-content: space-between;font-weight: bold; font-size: 18px">
						<p>CAMBIO</p>
						<p>0.00</p>
					</div>
					</br>
					</br>
					</br>
					</br>
					</br>
					</br>
					<p>Aplic.: HT</p>
					<div style="display: flex;justify-content: space-between;">
						<p><i style="font-weight: bold;">CF</i> HSHSAB0000036799</p>
						<p>v: 02.00</p>
					</div>
				`


	}

	const $form = document.getElementById('form')
	const $buttonEditFactura = document.querySelector('.editarFacturaButton')
	const $div = document.querySelector('.editFactura')

	$form.addEventListener('submit', handleSubmitEdit)


	/*
	EDITABLES:

		caja
		cajero
		numeroFactura

		cliente: {
			client,
			cuit,
			calleYNumeracion,
			localidadCodigoPostalProvincia,

		}
		pesosEntregados
		nombreCajero

	*/
	/*
		COMPONENTE ITEM:
		<div>
			<div style="display: flex; ">
				<p style="min-width: 39.5%; margin-left: 15px"><span id="cantidadProducto">5.00</span>/ <span id="precioProducto">190478.52</span></p>
				<p>(21.00)</p>
			</div>
			<p>á181241-4</p>
			<div style="display: flex; justify-content: space-between">
				<p>PACK 16 PANELES LANA VIDRIO</p>
				<p>952392.56</p>
			</div>
		</div>
	*/



	function printDiv() {
    // Selecciona el contenedor del ticket
    let ticket = document.querySelector('#ticket');

    // Almacena el contenido original del body
    let contenidoOriginal = document.body.innerHTML;

    // Reemplaza el contenido del body con el contenido del ticket
    document.body.innerHTML = ticket.outerHTML;

    // Llama a la función de impresión
    window.print();

    // Restaura el contenido original del body después de imprimir
    document.body.innerHTML = contenidoOriginal;

    // Opcionalmente, puedes recargar los scripts o reactivar los eventos si es necesario
    location.reload();
}

</script>
</html>