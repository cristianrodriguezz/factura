<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
	<style>
	*{
		box-sizing: border-box;
		-webkit-user-select: none; /* Chrome, Opera, Safari */
		-moz-user-select: none; /* Firefox 2+ */
		-ms-user-select: none; /* IE 10+ */
		user-select: none; /* Standard syntax */
		margin: 0;
		padding: 0;
		
	}
.font{
	font-family: monospace;
  font-size: 12px;
}


.bill-container{
  border-collapse: collapse;
  max-width: 8cm;
	min-width: 8cm;
  left:0;
  right: 0;
  border-collapse: collapse;
  font-family: monospace;
  font-size: 10.5px;
}
.title{
	font-family: monospace;
	font-size: 15px;
	text-align: center;
	letter-spacing: 4px;
	text-transform: uppercase;
	font-weight: 100;
}

.text-lg{
  font-size: 20px;
}

.text-center{
  text-align: center;
}

.title-second{
	font-family: monospace;
	font-size: 14px;
	text-align: center;
	letter-spacing: -0.2px;
	text-transform: uppercase;
	font-weight: 100;
	margin-top: 6px;
}


#qrcode {
  width: 75%
}

p {
  margin: 2px 0;
}

table table {
  width: 100%;
}
table{
	width: 100%;
}

table table tr td:last-child{
  text-align: right;
}

.border-top {
  border-top: 1px dashed;
}

.padding-b-3 {
  padding-bottom: 5px;
}

.padding-t-3 {
  padding-top: 5px;
}

form{
	display: flex;
	flex-direction: column;
}
.flex{
	display: flex;
} 
.justify-center{
	justify-content: space-between;
} 
.align-center{
	align-items: center;
}



	</style>
</head>
<body style="display: flex; gap: 50px; justify-content: center;">
	<div class="bill-container">
		<form id="form">
			<label for="client">Nombre de cliente:</label>
			<input type="text" name="client" id="client" >
			<label for="cuit">CUIT</label>
			<input type="text" name="cuit" id="cuit" >
			<label for="contribuyente">Contribuyente</label>
			<input type="text" name="contribuyente" id="contribuyente" >
			<label for="direccion">Dirección</label>
			<input type="text" name="direccion" id="direccion" >
			<label for="pago">Pago:</label>
			<input type="text" name="pago" id="pago" >
			<label for="fecha">Fecha:</label>
			<input type="text" placeholder="DD/MM/YYYY" name="fecha" id="fecha" >
			<label for="hora">Hora:</label>
			<input type="text" name="hora" id="hora" placeholder="HH:MM:SS" >
			<label for="total">Total:</label>
			<input type="text" name="total" id="total" >
			<label for="precioXLitro">precioXLitro:</label>
			<input type="text" name="precioXLitro" id="precioXLitro" >
			<label for="itc">ITC:</label>
			<input type="text" name="itc" id="itc" >
			<label for="factura">N° de factura:</label>
			<input type="text" name="factura" id="factura" >
			<label for="surtidor">N° de surtidor</label>
			<input type="text" name="surtidor" id="surtidor" >

			<button>enter</button>
		</form>

	</div>
	<div>


	<div class="bill-container" id="ticket">
		<div>
		</div>
		<table >
			<tr>
				<td class="padding-b-3">
					<p>COMBUSTIBLES ARGENTINOS Y CIA. S. R. L.</p>
					<p >C.U.I.T. Nro.: 30717521311</span></p>
					<p>Ing. Brutos: 01-30717521311</span></p>
					<p>PRINGLES 834 VILLA MERCEDES SL.5730</span></p>
					<p>Inicio de Actividades: 01/03/2022</span></p>
					<p>IVA Responsable Inscripto</p>
				</td>
			</tr>
			<tr>
				<td class="border-top padding-t-3 padding-b-3   ">
					<p style="min-width: 185px; text-align:center; letter-spacing: -0.2px"><strong>Cód. 081 - TIQUE FACTURA "A"</strong></p>
					<p style="text-align:end ;font-size: 11px;">N° <span id="numeroFactura">00006-00004370</span></p>

					<div style="display: flex; justify-content: space-between">
						<p>Fecha: <span class="fecha">03/10/2024</span> </p>
						<p>Hora <span class="hora">13:31:21</span></p>
					</div>
				</td>
			</tr>
			<tr>
				<td class="border-top padding-t-3 padding-b-3">
					<div style="letter-spacing: 0px;">
						<p>TRANSPORTE MARTINEZ E HIJOS</p>
						<p>C.U.I.T.: 30715271547</p>
						<p>IVA Responsable Inscripto</p>
						<p>SUIPACHA 670 MERCEDES</p>
						<p>(829 <span style="margin-left: 11px;">)</span> CONTADO </p>
						<br>
					</div>
				</td>
			<tr>
				<td class="border-top padding-t-3 padding-b-3">
					<p style="font-weight: bold;">Cantidad/Precio Unit.</p>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="min-width: 45%;">Descripción</p>
						<p style="min-width: 40px;">(%IVA)</p>
						<p>[%B.I.]</p>
						<p >Precio Neto</p>
					</div>
					<div class="deduccion">
					</div>
				</td>
			</tr>
			</tr>
		</table>

		<button onclick="printDiv()" style="height: 30px; width: 100%; margin-top: 20px; ">imprimir</button>
	</div>
</body>
<script>
	let date = new Date()
	let day = date.getDate()
	let month = (date.getMonth() + 1).toString().padStart(2, '0')
	let year = date.getFullYear()
	
	let fecha = `${day}/${month}/${year}`

	let hours = date.getHours().toString().padStart(2, '0')
	let minutes = date.getMinutes().toString().padStart(2, '0')
	let seconds = date.getSeconds().toString().padStart(2, '0')
	
	const hora =  `${hours}:${minutes}:${seconds}`

	const $fecha = document.querySelector('.fecha')
	const $hora = document.querySelector('.hora')


	const $client = document.querySelector('.client')
	const $cuit = document.querySelector('.cuit')
	const $contribuyente = document.querySelector('.contribuyente')
	const $direccion = document.querySelector('.direccion')
	const $pago = document.querySelector('.pago')
	const $deduccion = document.querySelector('.deduccion')
	const $numeroFactura = document.querySelector('#numeroFactura')



	function formatPesosARS(number) {
		const formattedNumber = new Intl.NumberFormat('es-AR', {
			style: 'currency',
			currency: 'ARS',
			maximumFractionDigits: 2,
		}).format(number)

		return formattedNumber
	}
	function formatDecimal(number) {

		return number.toLocaleString('es-ES', {
			minimumFractionDigits: 2,
			maximumFractionDigits: 3
		})
	}

	function sumar20Segundos(hora) {
		const [horas, minutos, segundos] = hora.split(':').map(Number);
	  
		let totalSegundos = horas * 3600 + minutos * 60 + segundos + 20;
	  
		const nuevasHoras = Math.floor(totalSegundos / 3600) % 24;
		totalSegundos %= 3600;
		const nuevosMinutos = Math.floor(totalSegundos / 60);
		const nuevosSegundos = totalSegundos % 60;
	  
		const formatoHora = String(nuevasHoras).padStart(2, '0');
		const formatoMinutos = String(nuevosMinutos).padStart(2, '0');
		const formatoSegundos = String(nuevosSegundos).padStart(2, '0');
	  
		return `${formatoHora}:${formatoMinutos}:${formatoSegundos}`;
	}


	const handleSubmitEdit = (e) => {
		e.preventDefault()

		const formData = new FormData(e.target)

	
		const data = {
			client: formData.get('client'),
			cuit: formData.get('cuit'),
			contribuyente: formData.get('contribuyente'),
			direccion: formData.get('direccion'),
			pago: formData.get('pago'),
			fecha: formData.get('fecha') || fecha,
			hora: formData.get('hora') || hora,
			total: parseFloat(formData.get('total')),
			precioXLitro: formData.get('precioXLitro'),
			itc: formData.get('itc'),
			factura: formData.get('factura'),
			surtidor: formData.get('surtidor')
		}

		$fecha.innerHTML = data.fecha
		$hora.innerHTML = data.hora
		$numeroFactura.innerText = data.factura

		let litros = data.total / data.precioXLitro

		let IVA = 21
		let tasa = 1.70
		let tasaXLitros = tasa * litros
		
		let ITC = data.itc * (data.total / data.precioXLitro)
		let subtotal = (data.total - (ITC * litros)) / 1.21
		let IVATotal = subtotal * 0.21
		let precioLitrosSinImpuesto = subtotal / litros
		let impuestoInterno = litros * ITC

		let itcXLitros = ITC * litros

		$deduccion.innerHTML = `	

					<p>${litros.toFixed(3)}/${precioLitrosSinImpuesto.toFixed(4)}</p>
					<p>ITC Unit.x Lt: ${ITC.toFixed(4)}</p>
					<p>(4)DIESEL 500</p>
					<div style="display: flex; justify-content: space-between">
						<p style="min-width: 45%;">${litros.toFixed(3)}-${data.precioXLitro}</p>
						<p>(21.00)</p>
						<p>[87.99]</p>
						<p style="min-width: 63.5px; text-align: end">${subtotal.toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="font-weight: bold">SUBTOTAL IMPORTE NETO NO GRAVADO</p>
						<p>0.00</p>
					</div>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="font-weight: bold">SUBTOTAL IMPORTE EXENTO</p>
						<p>0.00</p>
					</div>
					<div style="display: flex; justify-content: space-between; font-weight: bold;">
						<p style="font-weight: bold">SUBTOTAL IMPORTE NETO GRAVADO</p>
						<p>${subtotal.toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex;font-weight: bold;">
						<p style="min-width: 61%; font-weight: bold">Concepto</p>
						<p>Base</p>
					</div>
					<div style="display: flex;">
						<p style="min-width: 61%">Alícuota: 21.00%</p>
						<p>${subtotal.toFixed(2)}</p>
						<div style="display:flex; justify-content: end;  width: 100%">
							<p>${IVATotal.toFixed(2)}</p>
						</div>
					</div>
					<div style="display: flex;justify-content: space-between;font-weight: bold;">
						<p >IMPORTE TOTAL IVA</p>
						<p>${IVATotal.toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex;">
						<p style="min-width: 61%">10 - IMPUESTOS INTERNOS ITEMS</p>
						<p>${subtotal.toFixed(2)}</p>
						<div style="display:flex; justify-content: end;  width: 100%">
							<p>${itcXLitros.toFixed(2)}</p>
						</div>
					</div>
					<div style="display: flex;">
						<p style="min-width: 61%">99 - Tasas</p>
						<p>${tasa.toFixed(2)}</p>
						<div style="display:flex; justify-content: end;  width: 100%">
							<p>${tasaXLitros.toFixed(2)}</p>
						</div>
					</div>
					<div style="display: flex;justify-content: space-between;font-weight: bold;">
						<p >IMPORTE TOTAL OTROS TRIBUTOS</p>
						<p>${(itcXLitros + tasaXLitros).toFixed(2)}</p>
					</div>
					</br>
					<div style="display: flex;justify-content: space-between;font-weight: bold; font-size: 18px">
						<p >TOTAL</p>
						<p>${data.total.toFixed(2)}</p>
					</div>
					<p >RECIBI(MOS)</p>
					<div style="display: flex;justify-content: space-between;">
						<p>Efectivo...</p>
						<p>${data.total.toFixed(2)}</p>
					</div>
					<div style="display: flex;justify-content: space-between;font-weight: bold; font-size: 18px">
						<p>CAMBIO</p>
						<p>0.00</p>
					</div>
					</br>
					</br>
					</br>
					</br>
					</br>
					</br>
					<p>Aplic.: HT</p>
					<div style="display: flex;justify-content: space-between;">
						<p><i style="font-weight: bold;">CF</i> HSHSAB0000036799</p>
						<p>v: 02.00</p>
					</div>
				`


	}

	const $form = document.getElementById('form')
	const $buttonEditFactura = document.querySelector('.editarFacturaButton')
	const $div = document.querySelector('.editFactura')

	$form.addEventListener('submit', handleSubmitEdit)






	function printDiv() {
    // Selecciona el contenedor del ticket
		let ticket = document.querySelector('#ticket');

		// Almacena el contenido original del body
		let contenidoOriginal = document.body.innerHTML;

		// Reemplaza el contenido del body con el contenido del ticket
		document.body.innerHTML = ticket.outerHTML;

		// Llama a la función de impresión
		window.print();

		// Restaura el contenido original del body después de imprimir
		document.body.innerHTML = contenidoOriginal;

		// Opcionalmente, puedes recargar los scripts o reactivar los eventos si es necesario
		location.reload();
	}

</script>
</html>